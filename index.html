<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>XOLERIC CORE</title>
    <style>
        /* --- PREMIUM CSS STYLES --- */
        :root {
            --primary: #00ff88;
            --bg-color: #050505;
        }

        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background-color: var(--bg-color);
            font-family: 'Courier New', monospace;
            user-select: none;
        }

        #canvas-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }

        /* Loading Screen */
        #loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 1s ease-out;
        }

        .loader-text {
            color: var(--primary);
            font-size: 24px;
            letter-spacing: 5px;
            margin-bottom: 20px;
            text-shadow: 0 0 10px var(--primary);
            animation: pulse 1.5s infinite;
        }

        .loader-bar {
            width: 200px;
            height: 2px;
            background: #111;
            position: relative;
            overflow: hidden;
        }

        .loader-progress {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            width: 0%;
            background: var(--primary);
            box-shadow: 0 0 15px var(--primary);
            transition: width 0.2s ease;
        }

        /* UI Overlay */
        #ui-layer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 2;
            pointer-events: none;
            padding: 40px;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .hud-text {
            color: rgba(255, 255, 255, 0.5);
            font-size: 12px;
            letter-spacing: 2px;
        }

        .hud-title {
            color: #fff;
            font-size: 18px;
            font-weight: bold;
            text-shadow: 0 0 10px rgba(255,255,255,0.5);
        }

        @keyframes pulse {
            0% { opacity: 0.5; }
            50% { opacity: 1; }
            100% { opacity: 0.5; }
        }
    </style>

    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
            }
        }
    </script>
</head>
<body>

    <div id="loader">
        <div class="loader-text">WELCOME TO XOLERIC</div>
        <div class="loader-bar">
            <div class="loader-progress" id="progress-bar"></div>
        </div>
    </div>

    <div id="ui-layer">
        <div class="hud-top">
            <div class="hud-title">XOLERIC</div>
            <div class="hud-text">welcome to the project</div>
        </div>
        <div class="hud-bottom">
            <div class="hud-text">xoleric</div>
            <div class="hud-text" id="fps-counter">Ï€</div>
        </div>
    </div>

    <div id="canvas-container"></div>

    <script type="module">
        import * as THREE from 'three';
        import { EffectComposer } from 'three/addons/postprocessing/EffectComposer.js';
        import { RenderPass } from 'three/addons/postprocessing/RenderPass.js';
        import { UnrealBloomPass } from 'three/addons/postprocessing/UnrealBloomPass.js';

        class XolericSuperPremium {
            constructor() {
                this.container = document.getElementById('canvas-container');
                this.width = window.innerWidth;
                this.height = window.innerHeight;
                
                this.mouse = new THREE.Vector2();
                this.targetRotation = new THREE.Vector2();
                this.windowHalfX = this.width / 2;
                this.windowHalfY = this.height / 2;

                this.time = 0;
                this.hue = 0;

                this.init();
                this.addObjects();
                this.initPostProcessing(); // Bloom effekti
                this.addMatrixBackground();
                this.addEventListeners();
                this.animate();
                
                // Loading simulation
                this.simulateLoading();
            }

            simulateLoading() {
                let progress = 0;
                const bar = document.getElementById('progress-bar');
                const loader = document.getElementById('loader');
                
                const interval = setInterval(() => {
                    progress += Math.random() * 10;
                    if(progress > 100) progress = 100;
                    bar.style.width = `${progress}%`;
                    
                    if(progress === 100) {
                        clearInterval(interval);
                        setTimeout(() => {
                            loader.style.opacity = '0';
                            setTimeout(() => loader.style.display = 'none', 1000);
                        }, 500);
                    }
                }, 100);
            }

            init() {
                // Scene
                this.scene = new THREE.Scene();
                this.scene.fog = new THREE.FogExp2(0x000000, 0.02);

                // Camera
                this.camera = new THREE.PerspectiveCamera(50, this.width / this.height, 0.1, 100);
                this.camera.position.z = 7;

                // Renderer
                this.renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
                this.renderer.setSize(this.width, this.height);
                this.renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
                this.renderer.toneMapping = THREE.ReinhardToneMapping;
                this.container.appendChild(this.renderer.domElement);

                // Lighting (Muhim!)
                const ambientLight = new THREE.AmbientLight(0x404040, 2);
                this.scene.add(ambientLight);

                this.pointLight1 = new THREE.PointLight(0xffffff, 50, 20);
                this.pointLight1.position.set(2, 2, 2);
                this.scene.add(this.pointLight1);

                this.pointLight2 = new THREE.PointLight(0xffffff, 50, 20);
                this.pointLight2.position.set(-2, -2, 2);
                this.scene.add(this.pointLight2);
            }

            // --- PREMIUM GEOMETRIYA ---
            addObjects() {
                // 1. Asosiy Yadro (Glass Core)
                const coreGeometry = new THREE.BoxGeometry(2, 2, 2);
                
                // Dinamik Tekstura yaratish (Canvas Texture)
                const canvas = document.createElement('canvas');
                canvas.width = 512;
                canvas.height = 512;
                this.texCtx = canvas.getContext('2d');
                this.canvasTexture = new THREE.CanvasTexture(canvas);
                
                // Super Premium Material: Glass + Neon
                this.coreMaterial = new THREE.MeshPhysicalMaterial({
                    map: this.canvasTexture,
                    color: 0xffffff,
                    metalness: 0.1,
                    roughness: 0.05,
                    transmission: 0.6, // Shisha effekti
                    thickness: 1.5,
                    emissive: 0x000000,
                    emissiveIntensity: 1,
                    clearcoat: 1.0,
                    clearcoatRoughness: 0.1
                });

                this.coreCube = new THREE.Mesh(coreGeometry, this.coreMaterial);
                this.scene.add(this.coreCube);

                // 2. Tashqi Qobiq (Wireframe Cage)
                const cageGeometry = new THREE.BoxGeometry(2.5, 2.5, 2.5);
                const cageMaterial = new THREE.MeshBasicMaterial({ 
                    color: 0x00ff88, 
                    wireframe: true,
                    transparent: true,
                    opacity: 0.3
                });
                this.cage = new THREE.Mesh(cageGeometry, cageMaterial);
                this.scene.add(this.cage);

                // 3. Orbital Halqalar (Quantum Rings)
                const ringGeo = new THREE.TorusGeometry(3.5, 0.02, 16, 100);
                const ringMat = new THREE.MeshBasicMaterial({ color: 0xffffff });
                
                this.ring1 = new THREE.Mesh(ringGeo, ringMat);
                this.ring2 = new THREE.Mesh(ringGeo, ringMat);
                this.ring3 = new THREE.Mesh(ringGeo, ringMat);
                
                this.ring1.rotation.x = Math.PI / 2;
                this.ring2.rotation.y = Math.PI / 2;
                
                this.scene.add(this.ring1);
                this.scene.add(this.ring2);
                this.scene.add(this.ring3);

                // 4. Floating Data Particles (Zarrachalar)
                const particlesGeometry = new THREE.BufferGeometry();
                const particlesCount = 200;
                const posArray = new Float32Array(particlesCount * 3);

                for(let i = 0; i < particlesCount * 3; i++) {
                    posArray[i] = (Math.random() - 0.5) * 10;
                }

                particlesGeometry.setAttribute('position', new THREE.BufferAttribute(posArray, 3));
                this.particlesMaterial = new THREE.PointsMaterial({
                    size: 0.03,
                    color: 0xffffff,
                    transparent: true,
                    opacity: 0.8
                });

                this.particleSystem = new THREE.Points(particlesGeometry, this.particlesMaterial);
                this.scene.add(this.particleSystem);
            }

            // --- POST-PROCESSING (BLOOM) ---
            initPostProcessing() {
                const renderScene = new RenderPass(this.scene, this.camera);

                // UnrealBloomPass - Neon effekt beradi
                const bloomPass = new UnrealBloomPass(
                    new THREE.Vector2(this.width, this.height),
                    1.5, // strength (kuchliligi)
                    0.4, // radius
                    0.85 // threshold
                );
                bloomPass.strength = 1.8;
                bloomPass.radius = 0.5;
                bloomPass.threshold = 0.1;

                this.composer = new EffectComposer(this.renderer);
                this.composer.addPass(renderScene);
                this.composer.addPass(bloomPass);
            }

            // --- 2D MATRIX BACKGROUND ---
            addMatrixBackground() {
                this.bgCanvas = document.createElement('canvas');
                this.bgCanvas.style.position = 'fixed';
                this.bgCanvas.style.top = '0';
                this.bgCanvas.style.left = '0';
                this.bgCanvas.style.zIndex = '0'; // WebGL orqasida
                this.bgCanvas.style.opacity = '0.3';
                document.body.appendChild(this.bgCanvas);
                
                this.bgCtx = this.bgCanvas.getContext('2d');
                this.matrixDrops = [];
                
                this.resizeMatrix();
                
                // Initialize drops
                const columns = this.bgCanvas.width / 20;
                for(let i=0; i<columns; i++) {
                    this.matrixDrops[i] = 1;
                }
            }

            resizeMatrix() {
                this.bgCanvas.width = window.innerWidth;
                this.bgCanvas.height = window.innerHeight;
            }

            updateMatrix() {
                this.bgCtx.fillStyle = 'rgba(0, 0, 0, 0.05)';
                this.bgCtx.fillRect(0, 0, this.bgCanvas.width, this.bgCanvas.height);
                
                this.bgCtx.fillStyle = `hsl(${this.hue}, 100%, 50%)`;
                this.bgCtx.font = '15px monospace';
                
                const chars = "XOLERIC01";
                for(let i=0; i<this.matrixDrops.length; i++) {
                    const text = chars[Math.floor(Math.random()*chars.length)];
                    this.bgCtx.fillText(text, i*20, this.matrixDrops[i]*20);
                    
                    if(this.matrixDrops[i]*20 > this.bgCanvas.height && Math.random() > 0.975)
                        this.matrixDrops[i] = 0;
                    this.matrixDrops[i]++;
                }
            }

            updateTexture(time) {
                // Kub yuzasidagi jonli tekstura
                this.texCtx.fillStyle = '#000000';
                this.texCtx.fillRect(0, 0, 512, 512);
                
                this.texCtx.lineWidth = 10;
                this.texCtx.strokeStyle = `hsl(${this.hue}, 100%, 50%)`;
                this.texCtx.strokeRect(20, 20, 472, 472);
                
                this.texCtx.font = 'bold 80px Courier New';
                this.texCtx.textAlign = 'center';
                this.texCtx.textBaseline = 'middle';
                this.texCtx.fillStyle = `hsl(${this.hue}, 100%, 70%)`;
                
                const pulse = Math.sin(time * 2) * 20;
                this.texCtx.save();
                this.texCtx.translate(256, 256);
                this.texCtx.rotate(Math.sin(time) * 0.2);
                this.texCtx.fillText("XOLERIC", 0, -50 + pulse);
                this.texCtx.font = '40px Courier New';
                this.texCtx.fillText("core", 0, 50);
                this.texCtx.restore();
                
                this.canvasTexture.needsUpdate = true;
            }

            addEventListeners() {
                window.addEventListener('resize', this.onWindowResize.bind(this));
                document.addEventListener('mousemove', this.onDocumentMouseMove.bind(this));
                document.addEventListener('touchmove', this.onTouchMove.bind(this), {passive: false});
            }

            onWindowResize() {
                this.width = window.innerWidth;
                this.height = window.innerHeight;
                this.windowHalfX = this.width / 2;
                this.windowHalfY = this.height / 2;

                this.camera.aspect = this.width / this.height;
                this.camera.updateProjectionMatrix();
                this.renderer.setSize(this.width, this.height);
                this.composer.setSize(this.width, this.height);
                this.resizeMatrix();
            }

            onDocumentMouseMove(event) {
                this.mouse.x = (event.clientX - this.windowHalfX) * 0.001;
                this.mouse.y = (event.clientY - this.windowHalfY) * 0.001;
            }

            onTouchMove(event) {
                if (event.touches.length > 0) {
                    event.preventDefault(); // Scrollni bloklash
                    this.mouse.x = (event.touches[0].clientX - this.windowHalfX) * 0.002;
                    this.mouse.y = (event.touches[0].clientY - this.windowHalfY) * 0.002;
                }
            }

            animate() {
                requestAnimationFrame(this.animate.bind(this));

                this.time += 0.01;
                this.hue = (this.hue + 0.5) % 360;

                // 1. Update Colors
                const color = new THREE.Color(`hsl(${this.hue}, 100%, 50%)`);
                this.cage.material.color = color;
                this.particlesMaterial.color = color;
                this.coreMaterial.emissive = new THREE.Color(`hsl(${this.hue}, 100%, 20%)`);
                
                // Point lights follow hue but brighter
                this.pointLight1.color = color;
                this.pointLight2.color = new THREE.Color(`hsl(${(this.hue + 180)%360}, 100%, 50%)`);

                // 2. Physics & Rotation (Smooth Lerp)
                this.targetRotation.x = this.mouse.y * 5;
                this.targetRotation.y = this.mouse.x * 5;

                // Kub sekin-asta sichqonchaga ergashadi
                this.coreCube.rotation.x += (this.targetRotation.x - this.coreCube.rotation.x) * 0.05;
                this.coreCube.rotation.y += (this.targetRotation.y - this.coreCube.rotation.y) * 0.05;
                
                // Avtomatik aylanish komponentlari
                this.coreCube.rotation.z += 0.005;
                
                this.cage.rotation.copy(this.coreCube.rotation);
                this.cage.rotation.x *= -1; // Teskari aylanish (Complex effect)
                
                this.ring1.rotation.x += 0.02;
                this.ring1.rotation.y += 0.01;
                this.ring2.rotation.y -= 0.02;
                this.ring3.rotation.z += 0.01;

                this.particleSystem.rotation.y = this.time * 0.1;

                // 3. Update Textures & Background
                this.updateTexture(this.time);
                this.updateMatrix();

                // 4. Render with Bloom
                this.composer.render();
            }
        }

        // Dasturni ishga tushirish
        new XolericSuperPremium();
    </script>
</body>
</html>
